const $=e=>document.querySelector(e),$$=e=>document.querySelectorAll(e);let goalWord,goalChar0index,goalChar1index,goalChar2index,goalChar3index,goalChar4index,rowSize=5,moves=12,movesItTook=0,moveBonus=9,maxMoves=20,score=0,multiplier=1,bonusStreak=0,message="";function getRandomLetter(){let e=Math.floor(Math.random()*letterBag.length);return letterBag.charAt(e)}function getRandomGridIndex(){return Math.floor(Math.random()*Math.pow(rowSize,2))}function setRandomGoalWord(){let e=Math.floor(Math.random()*words.length);goalWord=words[e].toUpperCase()}function setGoalCharIndexes(){for(goalChar0index=getRandomGridIndex();!goalChar1index||goalChar1index===goalChar0index;)goalChar1index=getRandomGridIndex();for(;!goalChar2index||goalChar2index===goalChar0index||goalChar2index===goalChar1index;)goalChar2index=getRandomGridIndex();for(;!goalChar3index||goalChar3index===goalChar0index||goalChar3index===goalChar1index||goalChar3index===goalChar2index;)goalChar3index=getRandomGridIndex();for(;!goalChar4index||goalChar4index===goalChar0index||goalChar4index===goalChar1index||goalChar4index===goalChar2index||goalChar4index===goalChar3index;)goalChar4index=getRandomGridIndex()}function setGridLetters(){$$(".cell").forEach((e,a)=>{let o=getRandomLetter();a===goalChar0index?o=goalWord.charAt(0):a===goalChar1index?o=goalWord.charAt(1):a===goalChar2index?o=goalWord.charAt(2):a===goalChar3index?o=goalWord.charAt(3):a===goalChar4index&&(o=goalWord.charAt(4));let r=goalWord.indexOf(o);e.innerText=o,e.dataset.piece=r+1})}function swap(e){e.classList.toggle("selected");let a=$$(".selected");if(a.length>=2){let e=a[0],o=a[1],r=e.parentElement,t=o.parentElement;r.appendChild(o),t.appendChild(e),e.classList.remove("selected"),o.classList.remove("selected"),colorize(),evaluate()}}function colorize(){document.querySelectorAll(".cell").forEach(e=>{let a,o,r=parseInt(e.parentElement.dataset.gridx),t=parseInt(e.parentElement.dataset.gridy),n=e.innerText,l=goalWord.charAt(0),d=goalWord.charAt(1),i=goalWord.charAt(2),s=goalWord.charAt(3),g=goalWord.charAt(4);o=0===r?null:(a=$(`[data-gridx="${r-1}"][data-gridy="${t}"] .cell`)).innerText,e.classList.remove("green","yellow"),o===l&&n===d||o===d&&n===i||o===i&&n===s||o===s&&n===g?(e.classList.add("green"),a.classList.add("green")):goalWord.indexOf(n)>-1&&goalWord.indexOf(o)>-1&&(e.classList.add("yellow"),a&&a.classList.add("yellow"))})}function evaluate(){let e=!1;for(i=0;i<5;i++){let a="";for(ii=0;ii<5;ii++)a+=$(`[data-gridy="${i}"][data-gridx="${ii}"] .cell`).innerText;if(a===goalWord){e=!0;break}}e?((moves+=moveBonus)>=maxMoves&&bonusStreak?(moves=maxMoves,message="bonus streak",multiplier+=.5*++bonusStreak):moves>=maxMoves?(moves=maxMoves,bonusStreak++,message="bonus",multiplier+=.5):(message="victory",multiplier=1,bonusStreak=0),score+=Math.round(500/movesItTook*multiplier),movesItTook=0,say(message),updateHUD(),dealEm()):(moves--,movesItTook++,updateHUD(),console.log("moves: ",moves,"\nscore: ",score),moves<1&&(gameOver(),console.log("moves: ",moves)))}function say(e){$(".banner-text").classList.remove("hidden"),"bonus streak"===e?$(".banner-text").innerHTML=`${goalWord}!\n        <div class="cyan-text">ðŸ˜† BONUS STREAK ${bonusStreak}! <span class="yellow-text">x ${multiplier}!</span></div>`:"bonus"===e&&($(".banner-text").innerHTML=`${goalWord}!\n        <div class="cyan-text">ðŸ˜€ BONUS! <span class="yellow-text">x ${multiplier}!</span></div>`),"victory"===e&&($(".banner-text").innerHTML=`${goalWord}!\n      <div class="cyan-text">ðŸ™‚ Nice!</div>`)}function updateHUD(){$(".moves").innerText=moves,$(".score").innerText=score,$(".multiplier").innerText=multiplier,movesItTook>=1&&$(".banner-text").classList.add("hidden")}function dealEm(){setRandomGoalWord(),setGoalCharIndexes(),setGridLetters(),colorize(),console.log(goalWord),console.log(goalChar0index,goalChar1index,goalChar2index,goalChar3index,goalChar4index)}function gameOver(){confirm(`GAME OVER\n    Final Score: ${$(".score").innerText}\n    \n    The word was "${goalWord}"\n    Play Again?`)&&startGame()}function startGame(){moves=10,score=0,updateHUD(),dealEm()}!function(){for(i=0;i<25;i++){let e=document.createElement("div"),a=document.createElement("button");e.dataset.gridx=i%rowSize,e.dataset.gridy=Math.floor(i/rowSize),e.classList.add("grid-item"),e.appendChild(a),a.classList.add("btn","cell"),a.addEventListener("click",e=>{swap(e.target)}),$(".grid").appendChild(e)}}(),startGame();