const $=e=>document.querySelector(e),$$=e=>document.querySelectorAll(e);let goalWord,goalChar0index,goalChar1index,goalChar2index,goalChar3index,goalChar4index,rowSize=5,moves=10,movesItTook=0,moveBonus=9,maxMoves=20,score=0,multiplier=1,message="";function getRandomLetter(){let e=Math.floor(Math.random()*letterBag.length);return letterBag.charAt(e)}function getRandomGridIndex(){return Math.floor(Math.random()*Math.pow(rowSize,2))}function setRandomGoalWord(){let e=Math.floor(Math.random()*words.length);goalWord=words[e].toUpperCase()}function setGoalCharIndexes(){for(goalChar0index=getRandomGridIndex();!goalChar1index||goalChar1index===goalChar0index;)goalChar1index=getRandomGridIndex();for(;!goalChar2index||goalChar2index===goalChar0index||goalChar2index===goalChar1index;)goalChar2index=getRandomGridIndex();for(;!goalChar3index||goalChar3index===goalChar0index||goalChar3index===goalChar1index||goalChar3index===goalChar2index;)goalChar3index=getRandomGridIndex();for(;!goalChar4index||goalChar4index===goalChar0index||goalChar4index===goalChar1index||goalChar4index===goalChar2index||goalChar4index===goalChar3index;)goalChar4index=getRandomGridIndex()}function setGridLetters(){$$(".cell").forEach((e,a)=>{let o=getRandomLetter();a===goalChar0index?o=goalWord.charAt(0):a===goalChar1index?o=goalWord.charAt(1):a===goalChar2index?o=goalWord.charAt(2):a===goalChar3index?o=goalWord.charAt(3):a===goalChar4index&&(o=goalWord.charAt(4));let r=goalWord.indexOf(o);e.innerText=o,e.dataset.piece=r+1})}function swap(){let e=$$(".selected");if(e.length>=2){let a=e[0],o=e[1],r=a.parentElement,n=o.parentElement;r.appendChild(o),n.appendChild(a),a.classList.remove("selected"),o.classList.remove("selected"),colorize(),evaluate()}}function colorize(){document.querySelectorAll(".cell").forEach(e=>{let a,o,r=parseInt(e.parentElement.dataset.gridx),n=parseInt(e.parentElement.dataset.gridy),t=e.innerText,l=goalWord.charAt(0),d=goalWord.charAt(1),i=goalWord.charAt(2),s=goalWord.charAt(3),g=goalWord.charAt(4);o=0===r?null:(a=$(`[data-gridx="${r-1}"][data-gridy="${n}"] .cell`)).innerText,e.classList.remove("green","yellow"),o===l&&t===d||o===d&&t===i||o===i&&t===s||o===s&&t===g?(e.classList.add("green"),a.classList.add("green")):goalWord.indexOf(t)>-1&&goalWord.indexOf(o)>-1&&(e.classList.add("yellow"),a&&a.classList.add("yellow"))})}function evaluate(){let e=!1;for(i=0;i<5;i++){let a="";for(ii=0;ii<5;ii++)a+=$(`[data-gridy="${i}"][data-gridx="${ii}"] .cell`).innerText;if(a===goalWord){e=!0;break}}e?((moves+=moveBonus)>=maxMoves?(moves=maxMoves,message="bonus",multiplier+=.2):(message="victory",multiplier=1),say(message),score+=Math.round(500/movesItTook)*multiplier,movesItTook=0,updateHUD(),dealEm(),console.log("moves: ",moves,"\nscore: ",score)):(moves--,movesItTook++,updateHUD(),console.log("moves: ",moves,"\nscore: ",score),moves<1&&(gameOver(),console.log("moves: ",moves)))}function say(e){$(".banner-text").classList.remove("hidden"),"victory"===e?$(".banner-text").innerHTML=goalWord+"! ðŸ˜€":"bonus"===e&&($(".banner-text").innerHTML=`${goalWord}!!! ðŸ¤©\n        <div class="cyan-text">MOVE MAX-OUT! MULTIPLIER UP!</div>`)}function updateHUD(){$(".moves").innerText=moves,$(".score").innerText=score,$(".multiplier").innerText=multiplier,movesItTook>=1&&$(".banner-text").classList.add("hidden")}function dealEm(){setRandomGoalWord(),setGoalCharIndexes(),setGridLetters(),colorize(),console.log(goalWord),console.log(goalChar0index,goalChar1index,goalChar2index,goalChar3index,goalChar4index)}function gameOver(){confirm(`GAME OVER\n    Final Score: ${$(".score").innerText}\n    \n    The word was "${goalWord}"\n    Play Again?`)&&startGame()}function startGame(){moves=10,score=0,updateHUD(),dealEm()}!function(){for(i=0;i<25;i++){let e=document.createElement("div"),a=document.createElement("button");e.dataset.gridx=i%rowSize,e.dataset.gridy=Math.floor(i/rowSize),e.classList.add("grid-item"),e.appendChild(a),$(".grid").appendChild(e),a.classList.add("btn","cell"),a.addEventListener("click",e=>{e.target.classList.toggle("selected"),swap()})}}(),startGame();